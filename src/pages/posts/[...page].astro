---
import { type InferGetStaticPropsType, type GetStaticPaths, type GetStaticPathsOptions } from 'astro';
import { getCollection } from 'astro:content';
import RootLayout from '../../layouts/RootLayout.astro';
import Pagination from '../../components/blog/Pagination.astro';
import PostCard from '../../components/blog/PostCard.astro';
import { BLOG_INFO } from '../../consts';

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
	const posts = (await getCollection('blog')).sort(
		(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
	);
	return paginate(posts, { pageSize: 5 });
}

const { page } = Astro.props;
---

<RootLayout title={BLOG_INFO.title} description={BLOG_INFO.description}>
	<h3>All Posts</h3>
	<p class="count">{page.total} {page.total === 1 ? 'post' : 'posts'} found</p>
	<div class="posts-grid">
		{
			page.data.map((post) => (
				<PostCard post={post} />
			))
		}
	</div>
	
	<Pagination page={page} />
</RootLayout>

<style>
	.posts-grid {
		display: grid;
		gap: 1.5rem;
	}

	.count {
		color: var(--muted-foreground);
		margin-bottom: 2rem;
		font-size: 0.95rem;
	}
</style>

